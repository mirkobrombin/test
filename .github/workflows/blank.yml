name: Wine Arch Linux CI

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    container: archlinux:latest

    steps:
      - uses: actions/checkout@v2
      - name: Compile
        run: |
          wine_version="6.23"
          
          echo -e "[multilib]\nInclude = /etc/pacman.d/mirrorlist" >> /etc/pacman.conf
          pacman -Syu --noconfirm base-devel sudo git wget
          
      - name: Package
        run: |
          wget https://github.com/mirkobrombin/test/releases/download/test/wine-tkg-staging-fsync-git-6.17.r0.g5f19a815-326-x86_64.pkg.tar.zst
          tar --use-compress-program=unzstd -xvf wine-tkg-*
          ls
          mv usr /tmp/caffe-REL-x86_64
          cd /tmp && tar zcvf caffe-REL-x86_64.tar.gz caffe-REL-x86_64
          
      - name: Archive the artifacts
        uses: actions/upload-artifact@v2
        with:
          name: wine-tkg-build
          path: /tmp/caffe-REL-x86_64
